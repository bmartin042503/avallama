<!--
Copyright (c) Márk Csörgő and Martin Bartos
Licensed under the MIT License. See LICENSE file for details.
-->

<Styles xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:templatedControls="using:avallama.Styles.TemplatedControls"
        xmlns:controls="clr-namespace:avallama.Controls"
        xmlns:services="clr-namespace:avallama.Services">
    <Design.PreviewWith>

        <!-- To preview the items in Light/Dark theme change the RequestedThemeVariant to "Light" or to "Dark" -->
        <ThemeVariantScope RequestedThemeVariant="Light">
            <Border Background="{DynamicResource SurfaceContainer}">
                <StackPanel Orientation="Vertical"
                            Spacing="20" Margin="20"
                            MaxWidth="350">

                    <!-- Sample item 1 -->
                    <templatedControls:ConversationItem
                        Text="New conversation"
                        SubText="llama-3.2:latest" />

                    <!-- Sample item 2 -->
                    <templatedControls:ConversationItem
                        Text="Questions about C#"
                        SubText="qwen:7b" />

                    <!-- Sample item 3 - Selected conversation -->
                    <templatedControls:ConversationItem
                        Text="Talking lorem ipsum stuff"
                        SubText="deepseek-r1:14b"
                        Classes="selectedConversation" />

                    <!-- Sample item 4 -->
                    <templatedControls:ConversationItem
                        Text="Generating that story for the 954344th time"
                        SubText="gpt-oss:20b" />

                    <!-- Sample item 5 - Long conversation title -->
                    <templatedControls:ConversationItem
                        Text="This is the longest conversation title that I have ever seen in my entire life, I am kidding, this is probably not the longest conversation title. But who knows."
                        SubText="llama-3.2:latest" />

                </StackPanel>
            </Border>
        </ThemeVariantScope>

    </Design.PreviewWith>

    <!-- Style definitions for selected ConversationItem -->
    <Style Selector="templatedControls|ConversationItem.selectedConversation">

        <!-- Conversation title style -->
        <Style Selector="^ /template/ TextBlock#ConversationTitleTextBlock">
            <Setter Property="Foreground" Value="{DynamicResource OnPrimaryContainer}" />
        </Style>

        <!-- Conversation sub text style -->
        <Style Selector="^ /template/ TextBlock#ConversationSubTitleTextBlock">
            <Setter Property="Foreground" Value="{DynamicResource OnPrimaryContainer}" />
        </Style>

        <!-- Conversation background (border) style -->
        <Style Selector="^ /template/ Border#ConversationBorder">
            <Setter Property="Background" Value="{DynamicResource PrimaryContainer}" />
        </Style>

    </Style>

    <!-- Build of default ConversationItem -->
    <Style Selector="templatedControls|ConversationItem">
        <Setter Property="Template">
            <ControlTemplate>
                <Border
                    x:Name="ConversationBorder"
                    Background="{DynamicResource SurfaceContainerHighest}"
                    Padding="14,12"
                    CornerRadius="10"
                    Cursor="Hand"
                    ToolTip.Tip="{TemplateBinding Text}">

                    <!-- DeletePopup that appears at right click -->
                    <Border.ContextFlyout>
                        <controls:DeletePopup>
                            <Button
                                Content="{services:LocalizationService Key='DELETE'}"
                                Command="{TemplateBinding DeleteCommand}"
                                CommandParameter="{TemplateBinding DeleteCommandParameter}"
                                Classes="errorButton"/>
                        </controls:DeletePopup>
                    </Border.ContextFlyout>

                    <StackPanel Orientation="Vertical" Spacing="12">

                        <!-- Conversation title -->
                        <TextBlock
                            x:Name="ConversationTitleTextBlock"
                            Text="{TemplateBinding Text}"
                            FontFamily="{StaticResource Manrope}"
                            Foreground="{DynamicResource OnSurface}"
                            FontSize="16"
                            TextWrapping="NoWrap"
                            TextTrimming="CharacterEllipsis"
                            HorizontalAlignment="Left"
                            MaxLines="1" />

                        <!-- Conversation subtext -->
                        <TextBlock
                            x:Name="ConversationSubTitleTextBlock"
                            Text="{TemplateBinding SubText}"
                            FontFamily="{StaticResource Manrope}"
                            Foreground="{DynamicResource OnSurface}"
                            FontSize="12"
                            HorizontalAlignment="Right"
                            MaxLines="1" />
                    </StackPanel>
                </Border>
            </ControlTemplate>
        </Setter>
    </Style>
</Styles>
